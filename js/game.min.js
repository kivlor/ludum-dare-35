var bootState,debugStyle,loadState,menuState,playState,scoreStyle,textStyle;debugStyle={font:"normal 10px Verdana",fill:"#fc589c"},scoreStyle={font:"normal 12px Verdana",fill:"#ffffff",stroke:"#000000",strokeThickness:2},textStyle={font:"normal 18px Verdana",fill:"#ffffff",stroke:"#000000",strokeThickness:4},bootState={create:function(){return game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,game.scale.setUserScale(2,2),game.renderer.renderSession.roundPixels=!0,Phaser.Canvas.setImageRenderingCrisp(game.canvas),game.physics.startSystem(Phaser.Physics.ARCADE),game.stage.backgroundColor=16570500,game.state.start("load")}},loadState={preload:function(){var e,t,r;return t=game.world.centerX,r=game.world.centerY,e=game.add.text(t,r,"loading...",textStyle),e.anchor.setTo(.5,.5),game.load.spritesheet("terrain","images/terrain.png",256,48),game.load.spritesheet("vehicle","images/vehicle.png",24,48),game.load.spritesheet("obstacle","images/obstacle.png",32,32),game.load.audio("running","audio/running.mp3"),game.load.audio("shift","audio/shift.mp3"),game.load.audio("crash","audio/crash.mp3")},create:function(){return game.state.start("menu")}},menuState={create:function(){var e,t,r,a;return r=game.world.centerX,a=game.world.centerY,e=game.add.text(r,a,"spacebar to start",textStyle),e.anchor.setTo(.5,.5),t=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),t.onDown.addOnce(function(e){return function(){return game.state.start("play")}}(this))}},playState={init:function(){return this.SECOND=Phaser.Timer.SECOND,this.speed=4,this.score=0,this.scorer=null,this.timer=game.time.create(),this.terrainData={land:{name:"land",vehicle:"car",obstacle:1},sea:{name:"sea",vehicle:"boat",obstacle:2},air:{name:"air",vehicle:"plane",obstacle:3}},this.terrainNames=["land","sea","air"],this.currentTerrain=this.terrainData.land},create:function(){return this.cursorKeys=game.input.keyboard.createCursorKeys(),this.runningSound=game.add.audio("running"),this.crashSound=game.add.audio("crash"),this.shiftSound=game.add.audio("shift"),this.terrainLayer=game.add.group(),this.objectLayer=game.add.group(),this.playerLayer=game.add.group(),this.overlayLayer=game.add.group(),this.createPlayer(),this.createTerrains(),this.createObstacleTimer(),this.createShiftTimer(),this.timer.start(),this.scorer=game.add.text(4,220,this.score,scoreStyle)},update:function(){return this.player.isAlive?(game.physics.arcade.overlap(this.player,this.terrainLayer,function(e){return function(t,r){return e.player.vehicle!==r.vehicle?e.killPlayer():void 0}}(this),function(e){return function(t,r){var a,i;return r.name!==e.currentTerrain.name?!1:(a=t.position.y+24,i=r.position.y+480,i>a)}}(this)),game.physics.arcade.overlap(this.player,this.objectLayer,function(e){return function(t,r){return"obstacle"===r.type?e.killPlayer():e.shiftPlayer()}}(this)),this.movePlayer(),this.moveTerrains(),this.moveObjects(),this.updateScore()):void 0},createObstacleTimer:function(){return this.timer.loop(2.5*this.SECOND,function(e){return function(){return e.createObstacle()}}(this))},createShiftTimer:function(){return this.timer.loop(8*this.SECOND,function(e){return function(){return e.shiftTerrains(),e.createShifter()}}(this))},createTerrains:function(){var e,t,r,a,i,n,s;t=0,a=this.terrainData,i=[];for(r in a)e=a[r],s=r!==this.currentTerrain.name?-480:-240,n=game.add.tileSprite(0,s,256,480,"terrain",t),game.physics.arcade.enable(n),n.name=e.name,n.vehicle=e.vehicle,n.obstacles=e.obstacles,this.terrainLayer.add(n),i.push(t++);return i},shiftTerrains:function(){var e;for(e=game.rnd.pick(this.terrainNames);e===this.currentTerrain.name;)e=game.rnd.pick(this.terrainNames);return this.currentTerrain=this.terrainData[e]},moveTerrains:function(){return this.terrainLayer.forEach(function(e){return function(t){return t.name===e.currentTerrain.name?t.position.y<0?t.position.y=t.position.y+e.speed:t.position.y=-240:t.position.y>-480?t.position.y<240?t.position.y=t.position.y+e.speed:t.position.y=-480:void 0}}(this))},createPlayer:function(){return this.player=game.add.sprite(game.world.centerX,206,"vehicle"),this.player.isAlive=!0,this.player.anchor.setTo(.5,.5),game.physics.arcade.enable(this.player),this.player.animations.add("car",[0],1,!0),this.player.animations.add("boat",[1],1,!0),this.player.animations.add("plane",[2],1,!0),this.player.animations.play(this.currentTerrain.vehicle),this.player.vehicle=this.currentTerrain.vehicle,this.playerLayer.add(this.player),this.runningSound.loopFull()},movePlayer:function(){return this.player.isAlive?(this.cursorKeys.up.isDown&&this.player.position.y>36?this.player.body.velocity.y=-160:this.cursorKeys.down.isDown&&this.player.position.y<206?this.player.body.velocity.y=160:this.player.body.velocity.y=0,this.cursorKeys.left.isDown&&this.player.position.x>56?this.player.body.velocity.x=-160:this.cursorKeys.right.isDown&&this.player.position.x<200?this.player.body.velocity.x=160:this.player.body.velocity.x=0):void 0},killPlayer:function(){var e,t,r,a;return this.timer.removeAll(),this.timer.stop(),this.player.isAlive=!1,this.player.body.velocity.x=0,this.player.body.velocity.y=0,this.runningSound.stop(),this.crashSound.play(),r=game.world.centerX,a=game.world.centerY,e=game.add.text(r,a,"spacebar to restart",textStyle),e.anchor.setTo(.5,.5),t=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),t.onDown.addOnce(function(e){return function(){return game.state.start("play")}}(this))},shiftPlayer:function(){return this.player.vehicle!==this.currentTerrain.vehicle?(this.player.animations.play(this.currentTerrain.vehicle),this.player.vehicle=this.currentTerrain.vehicle,this.shiftSound.play()):void 0},createShifter:function(){var e,t,r;return t=game.rnd.pick([40,88,136,184]),r=-16,e=game.add.sprite(t,r,"obstacle",0),e.type="shifter",game.physics.arcade.enable(e),this.objectLayer.add(e)},createObstacle:function(){var e,t;return t=game.rnd.pick([40,88,136,184]),e=game.add.sprite(t,-32,"obstacle",this.currentTerrain.obstacle),e.type="obstacle",game.physics.arcade.enable(e),this.objectLayer.add(e)},moveObjects:function(){return this.objectLayer.length>0?this.objectLayer.forEach(function(e){return function(t){return t.position.y>240?t.destroy():t.position.y+=e.speed}}(this)):void 0},updateScore:function(){return this.score++,this.scorer.text=Math.floor(this.score/4)}};