var bootState,loadState,menuState,playState;bootState={create:function(){return game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,game.scale.setUserScale(2,2),game.renderer.renderSession.roundPixels=!0,Phaser.Canvas.setImageRenderingCrisp(game.canvas),game.physics.startSystem(Phaser.Physics.ARCADE),game.stage.backgroundColor=16570500,game.state.start("load")}},loadState={preload:function(){var e;return e=game.add.text(game.world.centerX,game.world.centerY,""),e.anchor.setTo(.5,.5),e.text="loading...",game.load.image("land","images/land.png"),game.load.image("sea","images/sea.png"),game.load.image("air","images/air.png"),game.load.image("barricade","images/barricade.png"),game.load.image("shifter","images/shifter.png"),game.load.spritesheet("vehicle","images/vehicle.png",24,48),game.load.audio("running","audio/running.mp3"),game.load.audio("shift","audio/shift.mp3"),game.load.audio("crash","audio/crash.mp3")},create:function(){return game.state.start("menu")}},menuState={create:function(){var e,t;return e=game.add.text(game.world.centerX,game.world.centerY),e.anchor.setTo(.5,.5),e.text="spacebar to start",t=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),t.onDown.addOnce(function(e){return function(){return game.state.start("play")}}(this))}},playState={init:function(){return this.SECOND=Phaser.Timer.SECOND,this.speed=4,this.timer=game.time.create(),this.trackData={land:{name:"land",vehicle:"car",obstacles:["barricade"]},sea:{name:"sea",vehicle:"boat",obstacles:["barricade"]}},this.trackNames=["land","sea"],this.currentTerrain=this.trackData.land},create:function(){return this.cursorKeys=game.input.keyboard.createCursorKeys(),this.runningSound=game.add.audio("running"),this.crashSound=game.add.audio("crash"),this.shiftSound=game.add.audio("shift"),this.terrainLayer=game.add.group(),this.objectLayer=game.add.group(),this.playerLayer=game.add.group(),this.overlayLayer=game.add.group(),this.createPlayer(),this.createTerrains(),this.createShiftTimer(),this.timer.start()},update:function(){return this.player.isAlive?(game.physics.arcade.overlap(this.player,this.terrainLayer,function(e){return function(t,a){return e.player.vehicle!==a.vehicle?e.killPlayer():void 0}}(this),function(e){return function(t,a){var r,i;return a.name!==e.currentTerrain.name?!1:(r=t.position.y+24,i=a.position.y+480,i>r)}}(this)),game.physics.arcade.overlap(this.player,this.objectLayer,function(e){return function(t,a){return"obstacle"===a.type?e.killPlayer():e.shiftPlayer()}}(this)),this.movePlayer(),this.moveTerrains(),this.moveObjects()):void 0},createObjectTimer:function(){return this.timer.loop(2*this.SECOND,function(e){return function(){return 0!==game.rnd.normal()?e.createObject():void 0}}(this))},createShiftTimer:function(){return this.timer.loop(5*this.SECOND,function(e){return function(){return e.shiftTerrains(),e.createShifter()}}(this))},createTerrains:function(){var e,t,a,r,i,n;a=this.trackData,r=[];for(t in a)e=a[t],n=t!==this.currentTerrain.name?-480:-240,i=game.add.tileSprite(0,n,256,480,e.name),game.physics.arcade.enable(i),i.name=e.name,i.vehicle=e.vehicle,i.obstacles=e.obstacles,r.push(this.terrainLayer.add(i));return r},shiftTerrains:function(){var e;for(e=game.rnd.pick(this.trackNames);e===this.currentTerrain.name;)e=game.rnd.pick(this.trackNames);return this.currentTerrain=this.trackData[e]},moveTerrains:function(){return this.terrainLayer.forEach(function(e){return function(t){return t.name===e.currentTerrain.name?t.position.y<0?t.position.y=t.position.y+e.speed:t.position.y=-240:t.position.y>-480?t.position.y<240?t.position.y=t.position.y+e.speed:t.position.y=-480:void 0}}(this))},createPlayer:function(){return this.player=game.add.sprite(game.world.centerX,206,"vehicle"),this.player.isAlive=!0,this.player.anchor.setTo(.5,.5),game.physics.arcade.enable(this.player),this.player.animations.add("car",[0],1,!0),this.player.animations.add("boat",[1],1,!0),this.player.animations.play(this.currentTerrain.vehicle),this.player.vehicle=this.currentTerrain.vehicle,this.playerLayer.add(this.player),this.runningSound.loopFull()},movePlayer:function(){return this.player.isAlive?(this.cursorKeys.up.isDown&&this.player.position.y>36?this.player.body.velocity.y=-160:this.cursorKeys.down.isDown&&this.player.position.y<206?this.player.body.velocity.y=160:this.player.body.velocity.y=0,this.cursorKeys.left.isDown&&this.player.position.x>56?this.player.body.velocity.x=-160:this.cursorKeys.right.isDown&&this.player.position.x<200?this.player.body.velocity.x=160:this.player.body.velocity.x=0):void 0},killPlayer:function(){var e,t;return this.timer.removeAll(),this.timer.stop(),this.player.isAlive=!1,this.player.body.velocity.x=0,this.player.body.velocity.y=0,this.runningSound.stop(),this.crashSound.play(),e=game.add.text(game.world.centerX,game.world.centerY),e.anchor.setTo(.5,.5),e.text="spacebar to retry",t=game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),t.onDown.addOnce(function(e){return function(){return game.state.start("play")}}(this))},shiftPlayer:function(){return this.player.vehicle!==this.currentTerrain.vehicle?(this.player.animations.play(this.currentTerrain.vehicle),this.player.vehicle=this.currentTerrain.vehicle,this.shiftSound.play()):void 0},createShifter:function(){var e,t,a;return t=game.rnd.pick([40,88,136,184]),a=this.currentTerrain,e=game.add.sprite(t,8,"shifter"),e.type="shifter",game.physics.arcade.enable(e),this.objectLayer.add(e)},createObject:function(){var e,t;return t=game.rnd.pick([40,88,136,184]),e=game.add.sprite(t,-16,"barricade"),e.type="obstacle",game.physics.arcade.enable(e),this.objectLayer.add(e)},moveObjects:function(){return this.objectLayer.length>0?this.objectLayer.forEach(function(e){return function(t){return t.position.y>240?t.destroy():t.position.y+=e.speed}}(this)):void 0}};